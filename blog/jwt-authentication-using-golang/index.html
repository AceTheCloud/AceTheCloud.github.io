<!doctype html><html><head><meta charset=utf-8><title>JWT Authentication using GoLang</title><meta name=viewport content="width=device-width,initial-scale=1"><meta name=viewport content="width=device-width,initial-scale=1,maximum-scale=1"><link rel=stylesheet href=https://acethecloud.com/themify/themify.css><link href=https://acethecloud.com/scss/critical.min.css rel=stylesheet><link rel=stylesheet href=https://acethecloud.com/css/custom.css><link rel="shortcut icon" href=https://acethecloud.com/images/favicon.png type=image/x-icon><link rel=icon href=https://acethecloud.com/images/favicon.png type=image/x-icon><script async src="https://www.googletagmanager.com/gtag/js?id=G-54XSTRSXS5"></script>
<script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-54XSTRSXS5")</script></head><body><nav class="main-nav navbar navbar-expand-lg"><div class=container-fluid><a class=navbar-brand href=https://acethecloud.com><img class=logo-main src=https://acethecloud.com/images/logo.png alt=logo-white></a>
<button class="navbar-toggler collapsed" type=button data-toggle=collapse data-target=#mainNav>
<span class=icon-bar></span>
<span class=icon-bar></span>
<span class=icon-bar></span></button><div class="collapse navbar-collapse nav-list" id=mainNav><ul class="navbar-nav ml-auto"><li class=nav-item><a href=https://acethecloud.com#hero class=nav-link>Home</a></li><li class=nav-item><a href=https://acethecloud.com#faq class=nav-link>Clouds</a></li><li class=nav-item><a href=https://acethecloud.com/contact class=nav-link>Contact</a></li></ul><div class="account-list list-inline"><li class=list-inline-item><a href=https://acethecloud.com/blog class="btn btn-sm btn-violate">Blog</a></li></div></div></div></nav><div id=content><meta property="og:image" content="https://acethecloud.com/images/blog/jwt-go.jpg"><meta property="og:image:type" content="image/png"><section class="page-header blog-single-header"><div class=container><div class=row><div class=col-lg-12><h2>JWT Authentication using GoLang</h2><div style=padding:5px><img src=https://acethecloud.com/images/blog/jwt-go.jpg alt=feature-image></div><div class=post-meta><ul><li><img src=https://acethecloud.com/images/client/abhishek.png alt=author-thumb></li><li><h5>Abhishek Gupta</h5></li><li></li><li>December 4, 2022</li><li></li><li><b>Read Time</b> :
6 minutes</li></ul><br><div style=scroll-behavior:auto><ul><li class=tag><b>Topics â‡¢</b></li><li class=tag><a href=https://acethecloud.com/tags/go-lang/>go-lang</a></li><li class=tag><a href=https://acethecloud.com/tags/web/>web</a></li><li class=tag><a href=https://acethecloud.com/tags/microservices/>microservices</a></li><li class=tag><a href=https://acethecloud.com/tags/authentication/>authentication</a></li><li class=tag><a href=https://acethecloud.com/tags/security/>security</a></li></ul></div></div></div></div></div></section><section class=blog-single><div class=container style=width:100%><div style=width:100%><article class=blog-single-post style=padding:30px><h3 id=what-is-jwt>What is JWT</h3><p>JSON Web Token (JWT) is a widely used standard for securely transmitting information between parties. It is commonly used to transmit information that can be verified and trusted, because it is digitally signed.</p><p>JWTs consist of three parts: a header, a payload, and a signature. The header typically consists of two parts: the type of the token, which is JWT, and the signing algorithm being used, such as HMAC SHA256 or RSA. The payload contains the claims. Claims are statements about an entity (typically, the user) and additional data. There are three types of claims: registered, public, and private claims. The signature is used to verify that the sender of the JWT is who it says it is and to ensure that the message wasn&rsquo;t changed along the way.</p><p>To create a JWT, you first need to create the header and payload, which are then encoded using base64url encoding. The resulting two strings are then concatenated, separated by a period (.). The final step is to create the signature by signing the concatenated string using the algorithm specified in the header.</p><p>When a JWT is received, it can be decoded and the signature can be verified to ensure that it was not tampered with. If the signature is valid, the claims in the payload can be trusted and used to grant access or perform other actions.</p><p>JWTs are commonly used for authentication and authorization purposes, because they allow the server to verify the identity of the client and grant access to protected resources. They are also used for securely transmitting information between parties, such as when exchanging information between microservices</p><h3 id=protecting-apis-using-jwt>Protecting APIs using JWT</h3><p>Here are some general steps you can follow to protect APIs using JSON Web Tokens (JWTs):</p><ol><li>Set up an authentication server:</li></ol><p>The first step is to set up an authentication server that is responsible for issuing and validating JWTs. This server should have a secure database to store user credentials and a way to authenticate users, such as by using username and password or by using third-party authentication providers like Google or Facebook.</p><ol start=2><li>Implement the login flow:</li></ol><p>To authenticate users, you need to implement a login flow that allows users to provide their credentials and receive a JWT in return. This typically involves sending a request to the authentication server with the user&rsquo;s credentials, and receiving a JWT in the response if the credentials are valid.</p><ol start=3><li>Secure your APIs:</li></ol><p>Once you have an authentication server set up and a login flow implemented, you can secure your APIs by requiring that clients provide a valid JWT in order to access them. This can be done by implementing a middleware or interceptor that checks for the presence of a JWT in the request header and verifies its signature and claims before allowing the request to proceed.</p><ol start=4><li>Refresh JWTs:</li></ol><p>JWTs have a limited lifespan, and will expire after a certain period of time. To ensure that users don&rsquo;t have to constantly log in, you can implement a refresh flow that allows users to request a new JWT when their current one expires. This can be done by sending a request to the authentication server with the expired JWT, and receiving a new JWT in the response.</p><p>By following these steps, you can use JWTs to secure your APIs and protect them from unauthorized access. It is important to keep in mind that JWTs are just one aspect of API security, and you should also consider implementing other measures such as input validation and rate limiting to ensure the security of your APIs.</p><h4 id=golang-code-to-implement-jwt-based-authentication>GoLang Code to implement JWT based Authentication</h4><div class=highlight><div style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 1
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 2
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 3
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 4
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 5
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 6
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 7
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 8
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 9
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">10
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">11
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">12
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">13
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">14
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">15
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">16
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">17
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">18
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">19
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">20
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">21
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">22
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">23
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">24
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">25
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">26
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">27
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">28
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">29
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">30
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">31
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">32
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">33
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">34
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">35
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">36
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">37
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">38
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">39
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">40
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">41
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">42
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">43
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">44
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">45
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">46
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">47
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">48
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">49
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">50
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">51
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">52
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">53
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">54
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">55
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">56
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">57
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">58
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">59
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">60
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">61
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">62
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">63
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">64
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">65
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">66
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">67
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">68
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">69
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">70
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">71
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">72
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">73
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">74
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">75
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">76
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">77
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">78
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">79
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">80
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">81
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">82
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-golang data-lang=golang><span style=display:flex><span><span style=color:#007020;font-weight:700>package</span> main
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#007020;font-weight:700>import</span> (
</span></span><span style=display:flex><span>	<span style=color:#4070a0>&#34;fmt&#34;</span>
</span></span><span style=display:flex><span>	<span style=color:#4070a0>&#34;log&#34;</span>
</span></span><span style=display:flex><span>	<span style=color:#4070a0>&#34;net/http&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>	<span style=color:#4070a0>&#34;github.com/dgrijalva/jwt-go&#34;</span>
</span></span><span style=display:flex><span>	<span style=color:#4070a0>&#34;github.com/gorilla/context&#34;</span>
</span></span><span style=display:flex><span>	<span style=color:#4070a0>&#34;github.com/gorilla/mux&#34;</span>
</span></span><span style=display:flex><span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#60a0b0;font-style:italic>// Create a struct that will be encoded to a JWT.
</span></span></span><span style=display:flex><span><span style=color:#60a0b0;font-style:italic>// We add jwt.StandardClaims as an embedded type, to provide fields like expiry time
</span></span></span><span style=display:flex><span><span style=color:#60a0b0;font-style:italic></span><span style=color:#007020;font-weight:700>type</span> Claims <span style=color:#007020;font-weight:700>struct</span> {
</span></span><span style=display:flex><span>	Username <span style=color:#902000>string</span> <span style=color:#4070a0>`json:&#34;username&#34;`</span>
</span></span><span style=display:flex><span>	jwt.StandardClaims
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#60a0b0;font-style:italic>// Create a signup handler
</span></span></span><span style=display:flex><span><span style=color:#60a0b0;font-style:italic></span><span style=color:#007020;font-weight:700>func</span> <span style=color:#06287e>SignupHandler</span>(w http.ResponseWriter, r <span style=color:#666>*</span>http.Request) {
</span></span><span style=display:flex><span>	<span style=color:#60a0b0;font-style:italic>// Get the username and password from the request body
</span></span></span><span style=display:flex><span><span style=color:#60a0b0;font-style:italic></span>	username <span style=color:#666>:=</span> r.<span style=color:#06287e>FormValue</span>(<span style=color:#4070a0>&#34;username&#34;</span>)
</span></span><span style=display:flex><span>	password <span style=color:#666>:=</span> r.<span style=color:#06287e>FormValue</span>(<span style=color:#4070a0>&#34;password&#34;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>	<span style=color:#60a0b0;font-style:italic>// Check if the username and password are valid
</span></span></span><span style=display:flex><span><span style=color:#60a0b0;font-style:italic></span>	<span style=color:#007020;font-weight:700>if</span> username <span style=color:#666>==</span> <span style=color:#4070a0>&#34;&#34;</span> <span style=color:#666>||</span> password <span style=color:#666>==</span> <span style=color:#4070a0>&#34;&#34;</span> {
</span></span><span style=display:flex><span>		http.<span style=color:#06287e>Error</span>(w, <span style=color:#4070a0>&#34;Username or password is empty&#34;</span>, http.StatusBadRequest)
</span></span><span style=display:flex><span>		<span style=color:#007020;font-weight:700>return</span>
</span></span><span style=display:flex><span>	}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>	<span style=color:#60a0b0;font-style:italic>// Create a new JWT token
</span></span></span><span style=display:flex><span><span style=color:#60a0b0;font-style:italic></span>	expiryTime <span style=color:#666>:=</span> time.<span style=color:#06287e>Now</span>().<span style=color:#06287e>Add</span>(time.Hour <span style=color:#666>*</span> <span style=color:#40a070>24</span>).<span style=color:#06287e>Unix</span>() <span style=color:#60a0b0;font-style:italic>// 24 hours
</span></span></span><span style=display:flex><span><span style=color:#60a0b0;font-style:italic></span>	claims <span style=color:#666>:=</span> <span style=color:#666>&amp;</span>Claims{
</span></span><span style=display:flex><span>		Username: username,
</span></span><span style=display:flex><span>		StandardClaims: jwt.StandardClaims{
</span></span><span style=display:flex><span>			ExpiresAt: expiryTime,
</span></span><span style=display:flex><span>		},
</span></span><span style=display:flex><span>	}
</span></span><span style=display:flex><span>	token <span style=color:#666>:=</span> jwt.<span style=color:#06287e>NewWithClaims</span>(jwt.SigningMethodHS256, claims)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>	<span style=color:#60a0b0;font-style:italic>// Sign and get the complete encoded token as a string
</span></span></span><span style=display:flex><span><span style=color:#60a0b0;font-style:italic></span>	signedToken, _ <span style=color:#666>:=</span> token.<span style=color:#06287e>SignedString</span>([]<span style=color:#007020>byte</span>(<span style=color:#4070a0>&#34;secret&#34;</span>))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>	<span style=color:#60a0b0;font-style:italic>// Save the token to the database
</span></span></span><span style=display:flex><span><span style=color:#60a0b0;font-style:italic></span>	<span style=color:#60a0b0;font-style:italic>// (omitted in this example)
</span></span></span><span style=display:flex><span><span style=color:#60a0b0;font-style:italic></span>
</span></span><span style=display:flex><span>	<span style=color:#60a0b0;font-style:italic>// Send the signed token to the client
</span></span></span><span style=display:flex><span><span style=color:#60a0b0;font-style:italic></span>	w.<span style=color:#06287e>Write</span>([]<span style=color:#007020>byte</span>(signedToken))
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#60a0b0;font-style:italic>// Create a login handler
</span></span></span><span style=display:flex><span><span style=color:#60a0b0;font-style:italic></span><span style=color:#007020;font-weight:700>func</span> <span style=color:#06287e>LoginHandler</span>(w http.ResponseWriter, r <span style=color:#666>*</span>http.Request) {
</span></span><span style=display:flex><span>	<span style=color:#60a0b0;font-style:italic>// Get the username and password from the request body
</span></span></span><span style=display:flex><span><span style=color:#60a0b0;font-style:italic></span>	username <span style=color:#666>:=</span> r.<span style=color:#06287e>FormValue</span>(<span style=color:#4070a0>&#34;username&#34;</span>)
</span></span><span style=display:flex><span>	password <span style=color:#666>:=</span> r.<span style=color:#06287e>FormValue</span>(<span style=color:#4070a0>&#34;password&#34;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>	<span style=color:#60a0b0;font-style:italic>// Check if the username and password are valid
</span></span></span><span style=display:flex><span><span style=color:#60a0b0;font-style:italic></span>	<span style=color:#007020;font-weight:700>if</span> username <span style=color:#666>==</span> <span style=color:#4070a0>&#34;&#34;</span> <span style=color:#666>||</span> password <span style=color:#666>==</span> <span style=color:#4070a0>&#34;&#34;</span> {
</span></span><span style=display:flex><span>		http.<span style=color:#06287e>Error</span>(w, <span style=color:#4070a0>&#34;Username or password is empty&#34;</span>, http.StatusBadRequest)
</span></span><span style=display:flex><span>		<span style=color:#007020;font-weight:700>return</span>
</span></span><span style=display:flex><span>	}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>	<span style=color:#60a0b0;font-style:italic>// Check if the username and password are correct
</span></span></span><span style=display:flex><span><span style=color:#60a0b0;font-style:italic></span>	<span style=color:#60a0b0;font-style:italic>// (omitted in this example)
</span></span></span><span style=display:flex><span><span style=color:#60a0b0;font-style:italic></span>
</span></span><span style=display:flex><span>	<span style=color:#60a0b0;font-style:italic>// Create a new JWT token
</span></span></span><span style=display:flex><span><span style=color:#60a0b0;font-style:italic></span>	expiryTime <span style=color:#666>:=</span> time.<span style=color:#06287e>Now</span>().<span style=color:#06287e>Add</span>(time.Hour <span style=color:#666>*</span> <span style=color:#40a070>24</span>).<span style=color:#06287e>Unix</span>() <span style=color:#60a0b0;font-style:italic>// 24 hours
</span></span></span><span style=display:flex><span><span style=color:#60a0b0;font-style:italic></span>	claims <span style=color:#666>:=</span> <span style=color:#666>&amp;</span>Claims{
</span></span><span style=display:flex><span>		Username: username,
</span></span><span style=display:flex><span>		StandardClaims: jwt.StandardClaims{
</span></span><span style=display:flex><span>			ExpiresAt: expiryTime,
</span></span><span style=display:flex><span>		},
</span></span><span style=display:flex><span>	}
</span></span><span style=display:flex><span>	token <span style=color:#666>:=</span> jwt.<span style=color:#06287e>NewWithClaims</span>(jwt.SigningMethodHS256, claims)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>	<span style=color:#60a0b0;font-style:italic>// Sign and get the complete encoded token as a string
</span></span></span><span style=display:flex><span><span style=color:#60a0b0;font-style:italic></span>	signedToken, _ <span style=color:#666>:=</span> token.<span style=color:#06287e>SignedString</span>([]<span style=color:#007020>byte</span>(<span style=color:#4070a0>&#34;secret&#34;</span>))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>	<span style=color:#60a0b0;font-style:italic>// Send the signed token to the client
</span></span></span><span style=display:flex><span><span style=color:#60a0b0;font-style:italic></span>	w.<span style=color:#06287e>Write</span>([]<span style=color:#007020>byte</span>(signedToken))
</span></span><span style=display:flex><span>}
</span></span></code></pre></td></tr></table></div></div><h3 id=creating-a-protected-handler-that-can-only-be-accessed-with-a-valid-jwt>Creating a protected handler that can only be accessed with a valid JWT</h3><div class=highlight><div style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 1
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 2
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 3
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 4
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 5
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 6
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 7
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 8
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 9
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">10
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">11
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">12
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">13
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">14
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">15
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">16
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">17
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">18
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">19
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">20
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">21
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">22
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">23
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">24
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">25
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">26
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">27
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">28
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">29
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">30
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">31
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">32
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">33
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">34
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">35
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">36
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">37
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">38
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">39
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">40
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">41
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">42
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">43
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">44
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-golang data-lang=golang><span style=display:flex><span><span style=color:#60a0b0;font-style:italic>// Create a protected handler
</span></span></span><span style=display:flex><span><span style=color:#60a0b0;font-style:italic></span><span style=color:#007020;font-weight:700>func</span> <span style=color:#06287e>ProtectedHandler</span>(w http.ResponseWriter, r <span style=color:#666>*</span>http.Request) {
</span></span><span style=display:flex><span>	<span style=color:#60a0b0;font-style:italic>// Get the JWT from the request header
</span></span></span><span style=display:flex><span><span style=color:#60a0b0;font-style:italic></span>	authHeader <span style=color:#666>:=</span> r.Header.<span style=color:#06287e>Get</span>(<span style=color:#4070a0>&#34;Authorization&#34;</span>)
</span></span><span style=display:flex><span>	<span style=color:#007020;font-weight:700>if</span> authHeader <span style=color:#666>==</span> <span style=color:#4070a0>&#34;&#34;</span> {
</span></span><span style=display:flex><span>		http.<span style=color:#06287e>Error</span>(w, <span style=color:#4070a0>&#34;Missing authorization header&#34;</span>, http.StatusUnauthorized)
</span></span><span style=display:flex><span>		<span style=color:#007020;font-weight:700>return</span>
</span></span><span style=display:flex><span>	}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>	<span style=color:#60a0b0;font-style:italic>// Extract the JWT from the authorization header
</span></span></span><span style=display:flex><span><span style=color:#60a0b0;font-style:italic></span>	tokenString <span style=color:#666>:=</span> strings.<span style=color:#06287e>TrimPrefix</span>(authHeader, <span style=color:#4070a0>&#34;Bearer &#34;</span>)
</span></span><span style=display:flex><span>	<span style=color:#007020;font-weight:700>if</span> tokenString <span style=color:#666>==</span> <span style=color:#4070a0>&#34;&#34;</span> {
</span></span><span style=display:flex><span>		http.<span style=color:#06287e>Error</span>(w, <span style=color:#4070a0>&#34;Invalid authorization header&#34;</span>, http.StatusUnauthorized)
</span></span><span style=display:flex><span>		<span style=color:#007020;font-weight:700>return</span>
</span></span><span style=display:flex><span>	}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>	<span style=color:#60a0b0;font-style:italic>// Parse the JWT
</span></span></span><span style=display:flex><span><span style=color:#60a0b0;font-style:italic></span>	token, err <span style=color:#666>:=</span> jwt.<span style=color:#06287e>ParseWithClaims</span>(tokenString, <span style=color:#666>&amp;</span>Claims{}, <span style=color:#007020;font-weight:700>func</span>(token <span style=color:#666>*</span>jwt.Token) (<span style=color:#007020;font-weight:700>interface</span>{}, <span style=color:#902000>error</span>) {
</span></span><span style=display:flex><span>		<span style=color:#007020;font-weight:700>return</span> []<span style=color:#007020>byte</span>(<span style=color:#4070a0>&#34;secret&#34;</span>), <span style=color:#007020;font-weight:700>nil</span>
</span></span><span style=display:flex><span>	})
</span></span><span style=display:flex><span>	<span style=color:#007020;font-weight:700>if</span> err <span style=color:#666>!=</span> <span style=color:#007020;font-weight:700>nil</span> {
</span></span><span style=display:flex><span>		http.<span style=color:#06287e>Error</span>(w, err.<span style=color:#06287e>Error</span>(), http.StatusUnauthorized)
</span></span><span style=display:flex><span>		<span style=color:#007020;font-weight:700>return</span>
</span></span><span style=display:flex><span>	}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>	<span style=color:#60a0b0;font-style:italic>// Check if the JWT is valid
</span></span></span><span style=display:flex><span><span style=color:#60a0b0;font-style:italic></span>	<span style=color:#007020;font-weight:700>if</span> !token.Valid {
</span></span><span style=display:flex><span>		http.<span style=color:#06287e>Error</span>(w, <span style=color:#4070a0>&#34;Invalid JWT&#34;</span>, http.StatusUnauthorized)
</span></span><span style=display:flex><span>		<span style=color:#007020;font-weight:700>return</span>
</span></span><span style=display:flex><span>	}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>	<span style=color:#60a0b0;font-style:italic>// Get the claims from the JWT
</span></span></span><span style=display:flex><span><span style=color:#60a0b0;font-style:italic></span>	claims, ok <span style=color:#666>:=</span> token.Claims.(<span style=color:#666>*</span>Claims)
</span></span><span style=display:flex><span>	<span style=color:#007020;font-weight:700>if</span> !ok {
</span></span><span style=display:flex><span>		http.<span style=color:#06287e>Error</span>(w, <span style=color:#4070a0>&#34;Invalid JWT claims&#34;</span>, http.StatusUnauthorized)
</span></span><span style=display:flex><span>		<span style=color:#007020;font-weight:700>return</span>
</span></span><span style=display:flex><span>	}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>	<span style=color:#60a0b0;font-style:italic>// Use the claims to do something, for example, get the username from the claims
</span></span></span><span style=display:flex><span><span style=color:#60a0b0;font-style:italic></span>	username <span style=color:#666>:=</span> claims.Username
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>	<span style=color:#60a0b0;font-style:italic>// Write a response to the client
</span></span></span><span style=display:flex><span><span style=color:#60a0b0;font-style:italic></span>	w.<span style=color:#06287e>Write</span>([]<span style=color:#007020>byte</span>(fmt.<span style=color:#06287e>Sprintf</span>(<span style=color:#4070a0>&#34;Hello, %s&#34;</span>, username)))
</span></span><span style=display:flex><span>}
</span></span></code></pre></td></tr></table></div></div><p>This protected handler first gets the JWT from the &lsquo;Authorization&rsquo; header of the request.
It then parses the JWT and verifies that it is valid. If the JWT is valid, the handler extracts the claims from the JWT and uses them to do something, for example, getting the username from the claims. If the JWT is invalid or there is any error during the parsing or verification process, the handler returns an error to the client.</p><p><strong>Here are a few things to consider when building an authentication server:</strong></p><p><strong>Security:</strong>
Make sure to use secure methods for storing and transmitting passwords, such as hashing and salting. Use secure communication channels, such as HTTPS, to prevent attackers from intercepting sensitive information.</p><p><strong>Scalability:</strong>
Consider the performance and scalability of your authentication server. Make sure that it can handle a large number of requests without breaking down.</p><p><strong>API design:</strong>
Design your API in a way that is easy to use and understand. Consider the use cases for your API and design it accordingly.</p><p><strong>Error handling:</strong>
Properly handle errors and return appropriate status codes and error messages to the client.</p><p><strong>Documentation:</strong>
Provide clear and comprehensive documentation for your API, including examples of how to use it and any relevant details about authentication and authorization.</p><p><strong>Testing:</strong>
Test your authentication server thoroughly to ensure that it is reliable and secure.</p><p><strong>Updates and maintenance:</strong>
Keep your authentication server up to date with the latest security patches and updates. Regularly monitor and maintain it to ensure that it continues to function as expected.</p></article></div></div><div class=container style=padding:50px><div id=disqus_thread></div><script type=application/javascript>window.disqus_config=function(){},function(){if(["localhost","127.0.0.1"].indexOf(window.location.hostname)!=-1){document.getElementById("disqus_thread").innerHTML="Disqus comments not available by default when the website is previewed locally.";return}var t=document,e=t.createElement("script");e.async=!0,e.src="//acethecloud.disqus.com/embed.js",e.setAttribute("data-timestamp",+new Date),(t.head||t.body).appendChild(e)}()</script><noscript>Please enable JavaScript to view the <a href=https://disqus.com/?ref_noscript>comments powered by Disqus.</a></noscript><a href=https://disqus.com class=dsq-brlink>comments powered by <span class=logo-disqus>Disqus</span></a></div></section></div><footer class=footer><div class=container><div class=row><div class=col-lg-12><div class=footer-subscribe-title><h2>Get the latest blog updates</h2></div></div><div class="col-lg-8 mx-auto"><form action=# class=footer-subscribe-form><div class=from-group><div class=input-group><input type=email class=form-control placeholder="Enter Your E-mail"><div class=subscribe><button class="btn btn-subscribe" type=submit>
<span class=btn-area>Subscribe</span><svg class="icon-left" xmlns="http://www.w3.org/2000/svg" width="16.317" height="15.323" viewBox="0 0 16.317 15.323"><g data-name="Group 1167"><g data-name="Group 1166"><path data-name="Path 1349" d="M.004 5.359a.7.7.0 00.587.693l6.091 1.609L.591 9.27a.7.7.0 00-.587.693v4.656a.7.7.0 00.206.5.726.726.0 00.119.1.7.7.0 00.675.044l14.911-6.958a.7.7.0 000-1.274L1.004.066a.7.7.0 00-1 .637zm13.952 2.3" fill="#fff"/></g></g></svg><svg class="icon-center" xmlns="http://www.w3.org/2000/svg" width="16.317" height="15.323" viewBox="0 0 16.317 15.323"><g data-name="Group 1167"><g data-name="Group 1166"><path data-name="Path 1349" d="M.004 5.359a.7.7.0 00.587.693l6.091 1.609L.591 9.27a.7.7.0 00-.587.693v4.656a.7.7.0 00.206.5.726.726.0 00.119.1.7.7.0 00.675.044l14.911-6.958a.7.7.0 000-1.274L1.004.066a.7.7.0 00-1 .637zm13.952 2.3" fill="#fff"/></g></g></svg></button></div></div></div></form></div></div><div class=row><div class="col-lg-4 col-md-4"><div class=footer-description><img src=https://acethecloud.com/images/logo.png alt=logo><p>All right reserved</br>Copyright Â© <a href=https://AceTheCloud.com/ target=_blank>AceTheCloud</a> 2022</p><ul class=footer-description-social><li><a href=https://facebook.com/cloud.and.mobile.evangelist/><i class=ti-facebook></i></a></li><li><a href=https://twitter.com/AbhiForTweeting><i class=ti-twitter-alt></i></a></li><li><a href=https://github.com/AbhiOnGithub><i class=ti-github></i></a></li></ul></div></div><div class="col-lg-4 col-md-4"><div class=footer-widget><h4>Sitemap</h4><div class=footer-widget-list><ul><li><a href=https://acethecloud.com>Home</a></li><li><a href=https://acethecloud.com/blog>Latest Article</a></li><li><a href=https://acethecloud.com/privacy>Privacy & Policy</a></li><li><a href=https://acethecloud.com/contact>Contact</a></li></ul></div></div></div><div class="col-lg-4 col-md-4"><div class=footer-widget><h4>Address</h4><div class=footer-widget-list><ul><li><a href=tel:><i class=ti-mobile></i></a></li><li><a href=mailto:abhishek@acethecloud.com><i class=ti-email></i>abhishek@acethecloud.com</a></li><li><p><i class=ti-pin></i></p></li></ul></div></div></div></div></div></footer><link href=https://acethecloud.com/scss/non-critical.min.css rel=stylesheet><script src=https://acethecloud.com/js/vendor.min.js></script>
<script src=https://acethecloud.com/js/script.min.js></script></body></html>